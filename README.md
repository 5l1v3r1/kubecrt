# kubecrt

Convert Helm charts to Kubernetes resources.

## Description

kubecrt allows you to define your Kubernetes infrastructure based on a single
yaml file, containing Chart names and (optionally) override variables for those
charts.

When running `kubecrt`, you provide it your project's configuration file, and in
turn, it returns you the parsed Kubernetes resource files generated by the
charts.

This allows you to use Helm Charts without actually using Helm, and instead
using regular `kubectl` to deploy and manage your resources.

The configuration file you feed into kubecrt will be processed using the epp
templating tool, allowing you to inject variables at runtime, based on your own
conditional logic (production vs staging, etc...).

## Installation

```
go get github.com/blendle/kubecrt
```

## Usage

See `kubecrt --help`

```
Usage:
  kubecrt [options] CHARTS_CONFIG
  kubecrt -h | --help
  kubecrt --version

  Arguments:
    CHARTS_CONFIG           Charts configuration file

  Options:
    -h, --help              Show this message
    --version               Display the kubecrt version
    --namespace=<ns>        Sets the .Release.Namespace Helm variable, which can
                            be used by Charts during compilation
    -n, --name=<name>       release name. If unspecified, it will autogenerate one
                            for you
    -o, --output=<path>     Write output to a file, instead of stdout
```

## Charts Configuration File

Here's an example of a project's configuration file:

```yaml
apiVersion: v1
charts:
  stable/factorio:
    resources:
      requests:
        memory: 1024Mi
        cpu: 750m
    factorioServer:
      name: {{ MY_SERVER_NAME | default:"hello world!" }}

  stable/minecraft:
    minecraftServer:
      difficulty: hard
```

Each Chart configuration starts with the chart location (a local path, or a
"Chart Repository" location), followed by the configuration for that chart,
which overrides the default configuration.

For the above example, see here for the default configurations:

  * stable/factorio: https://git.io/v9Tyr
  * stable/minecraft: https://git.io/v9Tya

The Chart Configuration file can also contain templated language which is
processed by [epp](https://github.com/blendle/epp).

In  the above example, the "MY_SERVER_NAME" value is expanded using your
exported environment variables. If none is found, "hello world!" will be the
default name.

epp uses [Pongo2](https://github.com/flosch/pongo2) for its templating
functionality.
